import{r as m,n as p,j as e,B as u,L as g,s as c}from"./index-DZwxJa6p.js";import{R as f}from"./refresh-cw-GX1sFyo7.js";const w=()=>{const[o,t]=m.useState(!1),{toast:s}=p(),l=async()=>{t(!0);try{const{data:{user:a}}=await c.auth.getUser();if(!a){s({title:"Erro",description:"Voc√™ precisa estar logado",variant:"destructive"});return}console.log("üîÑ Iniciando reconcilia√ß√£o de pagamentos pendentes...");const{data:n,error:r}=await c.functions.invoke("reconcile-pending-payments",{body:{userId:a.id}});if(r)throw r;console.log("‚úÖ Resultado da reconcilia√ß√£o:",n);const i=n.results.filter(d=>d.status==="reconciled").length;i>0?(s({title:"Pagamentos recuperados! üéâ",description:`${i} pagamento(s) pendente(s) foram confirmados e o acesso foi liberado.`,className:"bg-green-600 text-white border-green-700"}),setTimeout(()=>{window.location.reload()},2e3)):s({title:"Nenhum pagamento pendente",description:"Todos os seus pagamentos est√£o atualizados."})}catch(a){console.error("‚ùå Erro ao reconciliar pagamentos:",a),s({title:"Erro ao verificar pagamentos",description:a.message||"Tente novamente mais tarde",variant:"destructive"})}finally{t(!1)}};return e.jsx(u,{onClick:l,disabled:o,variant:"outline",className:"gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"h-4 w-4 animate-spin"}),"Verificando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"h-4 w-4"}),"Recuperar pagamentos pendentes"]})})};export{w as R};
