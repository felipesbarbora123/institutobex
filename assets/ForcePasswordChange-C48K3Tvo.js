import{r as n,m as g,n as j,u as v,j as a,a9 as P,B as b,s as l}from"./index-DZwxJa6p.js";import{I as m}from"./input-DDQYHuv2.js";import{L as u}from"./label-D0JfEdvX.js";import{C as N,b as y,c as C,d as S,a as E}from"./card-BXzsGqNW.js";import{o as A,Z as T,s as h}from"./types-CgaFKbNx.js";const F=A({newPassword:h().min(5,"Senha deve ter no mínimo 5 caracteres").max(100),confirmPassword:h()}).refine(e=>e.newPassword===e.confirmPassword,{message:"As senhas não coincidem",path:["confirmPassword"]});function U(){const[e,p]=n.useState(""),[i,f]=n.useState(""),[t,d]=n.useState(!1);g();const{toast:o}=j(),w=v(),x=async r=>{r.preventDefault(),d(!0);try{F.parse({newPassword:e,confirmPassword:i});const{error:s}=await l.auth.updateUser({password:e});if(s)throw s;const{error:c}=await l.auth.updateUser({data:{requires_password_change:!1}});if(c)throw c;o({title:"Senha alterada!",description:"Sua senha foi atualizada com sucesso."}),w("/admin")}catch(s){s instanceof T?o({title:"Erro de validação",description:s.errors[0].message,variant:"destructive"}):o({title:"Erro ao alterar senha",description:s.message,variant:"destructive"})}finally{d(!1)}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background via-muted/20 to-primary/5 p-4",children:a.jsxs(N,{className:"w-full max-w-md",children:[a.jsxs(y,{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-destructive mb-2",children:[a.jsx(P,{className:"w-6 h-6"}),a.jsx(C,{className:"text-2xl font-bold",children:"Alterar Senha Obrigatória"})]}),a.jsx(S,{children:"Você está usando uma senha temporária. Por segurança, altere sua senha agora."})]}),a.jsx(E,{children:a.jsxs("form",{onSubmit:x,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(u,{htmlFor:"newPassword",children:"Nova Senha"}),a.jsx(m,{id:"newPassword",type:"password",placeholder:"••••••••",value:e,onChange:r=>p(r.target.value),required:!0,disabled:t,autoFocus:!0}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Mínimo de 5 caracteres"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(u,{htmlFor:"confirmPassword",children:"Confirmar Nova Senha"}),a.jsx(m,{id:"confirmPassword",type:"password",placeholder:"••••••••",value:i,onChange:r=>f(r.target.value),required:!0,disabled:t})]}),a.jsx(b,{type:"submit",className:"w-full",disabled:t,children:t?"Alterando senha...":"Alterar Senha"})]})})]})})}export{U as default};
